<?xml version="1.0" encoding="UTF-8"?>
<document xmlns="http://maven.apache.org/XDOC/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/XDOC/2.0 http://maven.apache.org/xsd/xdoc-2.0.xsd">

	<properties>
		<title>SysML - Release Standard Operating Procedure</title>
	</properties>

	<body>
		<section name="sop5-Release">
			<subsection name="Who is in charge of?">
				<p>Committer + a basic developer in order to transfer knowledge and improve the process.</p>
			</subsection>
			<subsection name="When?">
				<p>when you need it, on a regular basis, every two month.</p>
			</subsection>
			<subsection name="How long?">
				<p>It last at least 120mn</p>
			</subsection>

		</section>
		<section name="Prerequisite">
			<subsection name="Access">
				<p>
					Have the Hudson access
				</p>
			</subsection>
			<subsection name="General release information">
				<p>
					You will find the general information on How to make a release for a Papyrus specialization <a href="https://www.eclipse.org/papyrus/components/components/components-0.0.18/user/sop-release.html">here</a>
				</p>
			</subsection>			
		</section>
		<section name="Pre-Actions">
			<p>You can send an email to the developers  mailing list.
			</p>
		</section>
		<section name="Steps">
			<subsection name="Create a bugzilla ticket.">
			</subsection>
			<subsection name="No critical bugs open for the release you are targeting">
			</subsection>
			<subsection name="Jobs (master,website,quality,deploy) are green">
			</subsection>
			<subsection name="Initial Version should match qualifier and -SNAPSHOT">
				<p>You must fill the changelog to describe the new version feature.</p>
				<source>/org.eclipse.papyrus-sysml/src/changes/changes.xml</source>
				<p>Details <a href="https://maven.apache.org/plugins/maven-changes-plugin/changes.html">https://maven.apache.org/plugins/maven-changes-plugin/changes.html</a></p>
			</subsection>
			<subsection name="Upgrade the version of application">
				<p>use tycho-versions plugin to switch from qualifier to release, and then back from release to qualifier</p>
				<source>mvn org.eclipse.tycho:tycho-versions-plugin:set-version -DnewVersion=X.Y.Z-SNAPSHOT</source>
				<p>check the different pom.xml and MANIFEST.MF</p>
				<p>You have to manually update the category.xml at /org.eclipse.papyrus-sysml/releng/org.eclipse.papyrus.sysml16.p2/category.xml</p>
			</subsection>
			<subsection name="Push on gerrit the different modifications">
				<p>Who: non committer action</p>
				<p>egit or others.</p>
			</subsection>
			<subsection name="Accept the changes">
				<p>Who: committer action</p>
				<p>gerrit web action.</p>
			</subsection>
			<subsection name="Rexecute the job Master and Website">
				<p>Who: any</p>
				<p>Goal is to use this job version as data for the promotion.</p>
			</subsection>
			<subsection name="Tag the release">
				<p>Who: committer action</p>
				<p>how</p>
			</subsection>
			<subsection name="Deploy the product (update site and the rcp)">
				<p>Who: non-committer action</p>
				<p>how: job on Hudson, fill the fields</p>
			</subsection>
			<subsection name="Deploy the web site">
				<p>Decision was taken by project leader Sebastien G. to not provide anymore website for components</p>
				<p>Who: non-committer action + committer review</p>
				<p>Generate the new web site</p>
				<source>mvn install site site:stage-deploy -Pproduct,documentation,documentation-pdf,quality,web.release -DsiteMainDirectory=/home/flefevre/tmp/sysml/site-staging -Dmaven.clean.skip=true -Dweb.absoluteResourceURL=https://www.eclipse.org/papyrus/components/sysml/3DIGITVERSION/ -Dweb.href=https://www.eclipse.org/papyrus/components/sysml/3DIGITVERSION/index.html</source>
				<p>Copy/paste it in the git repository dedicated to the web, in its own version folder</p>
				<p>Update the root index.html</p>
				<source>https://git.eclipse.org/c/www.eclipse.org/papyrus-sysml.git/</source>
			</subsection>
			<subsection name="Upgrade to the next snapshot version of the application">
				<p>use tycho-versions plugin</p>
				<source>mvn org.eclipse.tycho:tycho-versions-plugin:set-version -DnewVersion=X.Y.Z-SNAPSHOT</source>
				<p>You have to manually update the category.xml at /org.eclipse.papyrus-sysml/releng/org.eclipse.papyrus.sysml16.p2/category.xml</p>
				<p>check the different pom.xml and MANIFEST.MF</p>
			</subsection>			
		</section>
		<section name="Web-site release">
			<p>You need also to deploy the new web site matching your release product version.</p>
			<p>By going to <a href="https://hudson.eclipse.org/papyrus/view/Sysml/job/papyrus-sysml-eclipse-web-deploy/">https://hudson.eclipse.org/papyrus/view/Sysml/job/papyrus-sysml-eclipse-web-deploy/</a>, you could retrieve the zip of the site under the workspace ws/site-staging/3DIGITVERSION</p>
			<p>Then you have to submit a gerrit patch on the Papyrus git repository, located here: www.eclipse.org papyrus.git	modeling.mdt.papyrus project website</p>
			<p>You have also to modify the main index.html file to update the current website version and to add your version in the menu.</p>
			<p>The final result should be available after a few minutes here <a href="https://www.eclipse.org/papyrus/components/sysml/3DIGITVERSION/">https://www.eclipse.org/papyrus/components/sysml/3DIGITVERSION/</a></p>
		</section>
		<section name="Post-Actions">
			<p>You can send an email to the developers mailing list</p>
		</section>
		
	</body>

</document>